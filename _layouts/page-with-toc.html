<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% if page.title %}{{ page.title }} | {% endif %}{{ site.title }}</title>
    
    <!-- Main CSS -->
    <link rel="stylesheet" href="{{ '/assets/css/custom.css' | relative_url }}">
    
    <!-- Debug CSS (only if page specifies it) -->
    {% if page.extra_css %}
    <link rel="stylesheet" href="{{ page.extra_css | relative_url }}">
    {% endif %}
</head>
<body>
    <!-- HEADER -->
    <header class="site-header">
        <div class="wrapper">
            <a class="site-title" href="{{ '/' | relative_url }}">{{ site.title | default: site.github.repository_name }}</a>
            
            <nav class="site-nav">
                <input type="checkbox" id="nav-trigger" class="nav-trigger" />
                <label for="nav-trigger">
                    <span class="menu-icon">☰</span>
                </label>
                
                <div class="trigger">
                    {% for item in site.navigation %}
                    <a class="page-link" href="{{ item.link | relative_url }}">{{ item.name }}</a>
                    {% endfor %}
                </div>
            </nav>
        </div>
    </header>

    <div class="page-content">
        <div class="wrapper">
            <!-- SIDEBAR WITH TOC (NOT site navigation) -->
            <aside class="sidebar">
                <nav class="sidebar-toc">
                    <h3>TOC:</h3>
                    {% include toc-universal.html %}
                </nav>
            </aside>
            
            <!-- MAIN CONTENT -->
            <main class="main-content">
                {{ content }}
            </main>
        </div>
    </div>

    <footer class="site-footer">
        <div class="wrapper">
            <p>Hosted on GitHub Pages — Theme by <a href="https://github.com/orderedlist">orderedlist</a></p>
        </div>
    </footer>
<script>
// RELIABLE FIX for anchor links with fixed header
document.addEventListener('DOMContentLoaded', function() {
    const header = document.querySelector('.site-header');
    if (!header) return;
    
    const headerHeight = header.offsetHeight;
    const offset = headerHeight + 20; // 20px extra breathing room
    
    // Fix ALL anchor links on the page
    document.querySelectorAll('a[href^="#"]').forEach(link => {
        link.addEventListener('click', function(e) {
            const href = this.getAttribute('href');
            if (href === '#') return;
            
            const target = document.querySelector(href);
            if (target) {
                e.preventDefault();
                
                // Calculate position
                const targetPosition = target.offsetTop - offset;
                
                // Smooth scroll
                window.scrollTo({
                    top: targetPosition,
                    behavior: 'smooth'
                });
                
                // Update URL without scrolling
                history.pushState(null, null, href);
            }
        });
    });
});
</script>    
</body>
</html>
