<nav class="toc-nav">
  <ul class="toc-list">
    {% comment %} H2 headings {% endcomment %}
    {% assign content_lower = content | downcase %}
    {% assign h2_parts = content_lower | split: '<h2' %}
    
    {% for part in h2_parts %}
      {% if part contains 'id=' %}
        {% assign id_start = part | split: 'id="' | last %}
        {% assign id = id_start | split: '"' | first %}
        
        {% assign after_bracket = part | split: '>' %}
        {% if after_bracket.size > 1 %}
          {% assign title_with_tag = after_bracket | last %}
          {% assign title = title_with_tag | split: '</h2' | first %}
          
          <li class="toc-h2">
            <a href="#{{ id }}">{{ title | strip }}</a>
          </li>
        {% endif %}
      {% endif %}
    {% endfor %}
    
    {% comment %} H3 headings {% endcomment %}
    {% assign h3_parts = content_lower | split: '<h3' %}
    
    {% for part in h3_parts %}
      {% if part contains 'id=' %}
        {% assign id_start = part | split: 'id="' | last %}
        {% assign id = id_start | split: '"' | first %}
        
        {% assign after_bracket = part | split: '>' %}
        {% if after_bracket.size > 1 %}
          {% assign title_with_tag = after_bracket | last %}
          {% assign title = title_with_tag | split: '</h3' | first %}
          
          <li class="toc-h3">
            <a href="#{{ id }}">{{ title | strip }}</a>
          </li>
        {% endif %}
      {% endif %}
    {% endfor %}
  </ul>
</nav>
