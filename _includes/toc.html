<nav class="toc-nav">
  {% assign headings = content | split: '<h' %}
  {% assign has_headings = false %}

  <ul class="toc-list">
  {% for heading in headings %}
    {% if heading contains 'id=' %}
      {% assign has_headings = true %}
      {% assign level = heading | slice: 0 %}
      {% assign id_start = heading | split: 'id="' | last %}
      {% assign id = id_start | split: '"' | first %}
      {% assign title = heading | split: '>' | last | split: '</h' | first %}

      <li class="toc-h{{ level }}">
        <a href="#{{ id }}">{{ title | strip_html | strip }}</a>
      </li>
    {% endif %}
  {% endfor %}

  {% unless has_headings %}
    <li class="toc-empty">No headings found in this page</li>
  {% endunless %}
  </ul>
</nav>